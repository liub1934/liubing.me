import{_ as e,c as s,a,o as n}from"./app-DyfPPSu6.js";const t={};function r(l,i){return n(),s("div",null,i[0]||(i[0]=[a(`<h1 id="amh-面板安装及管理-docker-应用" tabindex="-1"><a class="header-anchor" href="#amh-面板安装及管理-docker-应用"><span>AMH 面板安装及管理 Docker 应用</span></a></h1><p>AMH 面板官方暂不支持 Docker 应用的管理，需要自己动手手动安装 Docker 应用，最后再安装一个人气很高的 Docker 面板可视化工具 Portainer 即可，记录下安装过程。</p><h2 id="docker-安装" tabindex="-1"><a class="header-anchor" href="#docker-安装"><span>Docker 安装</span></a></h2><p>这里可以参考 Docker 官网教程<a href="https://docs.docker.com/engine/install/centos/" target="_blank" rel="noopener noreferrer">Install Docker Engine on CentOS</a>食用。</p><h3 id="删除旧版本-docker" tabindex="-1"><a class="header-anchor" href="#删除旧版本-docker"><span>删除旧版本 Docker</span></a></h3><p>如果之前有安装过 Docker 的可以使用下面的命令删除 Docker 的内容。如果是新系统没有安装过 Docker，可以忽略这一步。</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> yum</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> remove</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> docker</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  docker-client</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  docker-client-latest</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  docker-common</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  docker-latest</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  docker-latest-logrotate</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  docker-logrotate</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  docker-engine</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="安装方法" tabindex="-1"><a class="header-anchor" href="#安装方法"><span>安装方法</span></a></h3><p>这里推荐官网使用 rpm 存储库安装，在新主机上首次安装 Docker 之前，需要设置 Docker 存储库。之后可以从存储库安装和更新 Docker。</p><h4 id="设置存储库" tabindex="-1"><a class="header-anchor" href="#设置存储库"><span>设置存储库</span></a></h4><p>安装<code>yum-utils</code>软件包（提供<code>yum-config-manager</code> 实用程序）并设置存储库。</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> yum</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> install</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -y</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> yum-utils</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> yum-config-manager</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --add-repo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> https://download.docker.com/linux/centos/docker-ce.repo</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="安装-docker-引擎" tabindex="-1"><a class="header-anchor" href="#安装-docker-引擎"><span>安装 Docker 引擎</span></a></h4><p>这里一般安装最新版本即可。</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> yum</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> install</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> docker-ce</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> docker-ce-cli</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> containerd.io</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> docker-buildx-plugin</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> docker-compose-plugin</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>此命令会安装 Docker，但不会启动 Docker。它还创建一个 docker 组，但是默认情况下不会将任何用户添加到该组。</p><p>别忘了最后启动 Docker。</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> start</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> docker</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>验证下 Docker 命令是否可用，在服务器终端上输入<code>docker</code>，如果能出现以下内容说明是 OK 的。</p><figure><img src="https://image.liubing.me/i/2023/12/10/65752f4c77811.png" alt="image" tabindex="0" loading="lazy"><figcaption>image</figcaption></figure><h2 id="安装-portainer-面板" tabindex="-1"><a class="header-anchor" href="#安装-portainer-面板"><span>安装 Portainer 面板</span></a></h2><p>如果追求新版本更新和新功能可以参考 Portainer 官网的<a href="https://docs.portainer.io/start/install/server/docker/linux" target="_blank" rel="noopener noreferrer">Install Portainer BE with Docker on Linux</a>的教程使用下面的命令进行安装：</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> volume</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> create</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> portainer_data</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> run</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -d</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -p</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 8000:8000</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -p</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 9443:9443</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --name</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> portainer</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --restart=always</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -v</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /var/run/docker.sock:/var/run/docker.sock</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -v</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> portainer_data:/data</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> portainer/portainer-ee:latest</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>这里博主选择安装汉化版本的 Portainer，虽然新功能跟不上官网版本，但是整理功能大差不差，也足够日常使用，可以参考我不是矿神写的<a href="https://imnks.com/3406.html" target="_blank" rel="noopener noreferrer">Docker 管理面板 Portainer 中文汉化 新增 CE、EE 企业版汉化</a>教程，找到推荐使用的版本 DockerHub：<a href="https://hub.docker.com/r/6053537/portainer-ce" target="_blank" rel="noopener noreferrer">https://hub.docker.com/r/6053537/portainer-ce</a></p><p>使用里面的一键安装代码进行快速安装：</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> run</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -d</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --restart=always</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --name=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;portainer&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -p</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 9000:9000</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -v</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /var/run/docker.sock:/var/run/docker.sock</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 6053537/portainer-ce</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>安装完成如果没啥意外的话，访问 <code>http://VPSIP:9000/</code>即可访问到 Portainer 面板。登录后就能很方便的进行 Docker 应用的管理了，不比宝塔面板的 Docker 管理差。</p><figure><img src="https://image.liubing.me/i/2023/12/10/6575328289065.png" alt="image" tabindex="0" loading="lazy"><figcaption>image</figcaption></figure><figure><img src="https://image.liubing.me/i/2023/12/10/657532c38d0f8.png" alt="image" tabindex="0" loading="lazy"><figcaption>image</figcaption></figure><figure><img src="https://image.liubing.me/i/2023/12/10/6575330b43750.png" alt="image" tabindex="0" loading="lazy"><figcaption>image</figcaption></figure><h2 id="portainer-面板绑定域名" tabindex="-1"><a class="header-anchor" href="#portainer-面板绑定域名"><span>Portainer 面板绑定域名</span></a></h2><p>在 AMH 面板<code>LNGX虚拟主机</code>中添加一个站点，如<code>docker.liubing.me</code></p><p>需要先在应用商店安装<code>LNGX</code>，点击<code>管理</code>按钮。</p><figure><img src="https://image.liubing.me/i/2023/12/10/6575347866a9d.png" alt="image" tabindex="0" loading="lazy"><figcaption>image</figcaption></figure><p>选择 <code>LNGX环境列表</code>，点击<code>创建LNGX环境</code>按钮创建一个运行环境，如果已经创建可以忽略该步骤。</p><figure><img src="https://image.liubing.me/i/2023/12/10/657534ae10cb9.png" alt="image" tabindex="0" loading="lazy"><figcaption>image</figcaption></figure><p>在<code>主机列表</code>中新增虚拟主机，<code>后端源站地址</code>中使用<code>http://127.0.0.1:9000</code>，其中<code>9000</code>端口和 Portainer 面板的端口保持一致。</p><figure><img src="https://image.liubing.me/i/2023/12/10/65753576a0e17.png" alt="image" tabindex="0" loading="lazy"><figcaption>image</figcaption></figure><p>新增成功后在<code>SSL证书</code>中设置站点的<code>https</code>访问。</p><p>最后打开域名就能访问到 Portainer 面板了。</p>`,40)]))}const p=e(t,[["render",r]]),k=JSON.parse('{"path":"/article/amh/amh-panel-install-docker.html","title":"AMH 面板安装及管理 Docker 应用","lang":"zh-CN","frontmatter":{"date":"2023-12-10T00:00:00.000Z","category":["AMH面板"],"tag":["AMH面板","Docker","Portainer"],"layout":"ArticleLayout","containerClass":"article-container","description":"AMH 面板官方暂不支持 Docker 应用的管理，需要自己动手手动安装 Docker 应用，最后再安装一个人气很高的 Docker 面板可视化工具 Portainer 即可，记录下安装过程。","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"AMH 面板安装及管理 Docker 应用\\",\\"image\\":[\\"https://image.liubing.me/i/2023/12/10/65752f4c77811.png\\",\\"https://image.liubing.me/i/2023/12/10/6575328289065.png\\",\\"https://image.liubing.me/i/2023/12/10/657532c38d0f8.png\\",\\"https://image.liubing.me/i/2023/12/10/6575330b43750.png\\",\\"https://image.liubing.me/i/2023/12/10/6575347866a9d.png\\",\\"https://image.liubing.me/i/2023/12/10/657534ae10cb9.png\\",\\"https://image.liubing.me/i/2023/12/10/65753576a0e17.png\\"],\\"datePublished\\":\\"2023-12-10T00:00:00.000Z\\",\\"dateModified\\":\\"2024-01-02T06:17:41.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Bing🐣\\"}]}"],["meta",{"property":"og:url","content":"https://liubing.me/article/amh/amh-panel-install-docker.html"}],["meta",{"property":"og:site_name","content":"Bing🐣"}],["meta",{"property":"og:title","content":"AMH 面板安装及管理 Docker 应用"}],["meta",{"property":"og:description","content":"AMH 面板官方暂不支持 Docker 应用的管理，需要自己动手手动安装 Docker 应用，最后再安装一个人气很高的 Docker 面板可视化工具 Portainer 即可，记录下安装过程。"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://image.liubing.me/i/2023/12/10/65752f4c77811.png"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-01-02T06:17:41.000Z"}],["meta",{"property":"article:tag","content":"Portainer"}],["meta",{"property":"article:tag","content":"Docker"}],["meta",{"property":"article:tag","content":"AMH面板"}],["meta",{"property":"article:published_time","content":"2023-12-10T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2024-01-02T06:17:41.000Z"}]]},"git":{"createdTime":1702180538000,"updatedTime":1704176261000,"contributors":[{"name":"liub1934","username":"liub1934","email":"liub1934@gmail.com","commits":2,"url":"https://github.com/liub1934"}]},"readingTime":{"minutes":2.75,"words":824},"filePathRelative":"article/amh/amh-panel-install-docker.md","excerpt":"\\n<p>AMH 面板官方暂不支持 Docker 应用的管理，需要自己动手手动安装 Docker 应用，最后再安装一个人气很高的 Docker 面板可视化工具 Portainer 即可，记录下安装过程。</p>\\n","autoDesc":true}');export{p as comp,k as data};
